05 REM CURRENTLY THIS DOES NOT WORK CORRECTLY

10 REM TEST PROGRAM FOR QUAZAR'S SID INTERFACE
15 REM ON A RC2014 RUNNING ROMWBW 3.0.1

20 REM == POKE IN ASSEMBLY AT 0xF800 ==
30 LET MB=&HF800
100 PRINT "Poking in the assembly...";
110 READ OP
120 IF OP = 999 THEN GOTO 160
130 POKE MB, OP
140 LET MB = MB + 1
150 GOTO 110
160 PRINT "...Done!"

200 REM == JP to CLEAR-SID (c3 00 f8 = jp f81E) ==
210 MB = &H2293
220 POKE MB, &HC3
230 POKE MB+1, &H1E
240 POKE MB+2, &HF8
250 PRINT "Calling CLEAR-SID()...";
260 R = USR(0)
270 PRINT "Done!"

300 REM == SETUP USRLOC to call SID-IO-BAS at 0xF800 == 
310 POKE MB+1, &H00
315 LET S = 54272 : REM THIS IS JUST FOR THE C64
320 LET I = 0 : REM TURN OFF INTERRUPTS
 
400 REM *** RC2014 SID SOUND TEST ***
405 PRINT "Running RC2014 SID sound test...";
420 V(0)=0 : V(1)=7 : V(2)=14
430 R = 24 : D = 15 : GOSUB 1000
431 FOR I = 0 TO 2
440 R = V(I)+3 : D = 8 : GOSUB 1000
441 R = V(I)+1 : D = 0 : GOSUB 1000
450 R = V(I)+5 : D = 8 : GOSUB 1000
451 R = V(I)+6 : D = 198 : GOSUB 1000
452 NEXT
460 FOR A = 16 TO 128 STEP 16
461 FOR I = 0 TO 2
470 IF A > 64 THEN R = V(I)+3 : D = 0 : GOSUB 1000
480 R = V(I)+4 : D = A+1 : GOSUB 1000
490 FOR F = 0 TO 254 STEP 2
491 R = V(I)+1 : D = F : GOSUB 1000 : NEXT F
500 R = V(I)+4 : D = A : GOSUB 1000
501 FOR W = 0 TO 200 : NEXT W
510 R = V(I)+4 : D = 8 : GOSUB 1000
511 R = V(I)+1 : D = 0 : GOSUB 1000
520 NEXT I,A : A = 1
530 FOR I = 0 TO 2
531 R = V(I)+1 : D = 255 : GOSUB 1000
540 R = 24 : D = (A*16)+15: GOSUB 1000
541 R = 23 : D = 2^I : GOSUB 1000
550 R = V(I)+4 : D = 129 : GOSUB 1000
560 FOR F = 0 TO 255
561 R = 22 : D = F : GOSUB 1000 : NEXT F
570 R = V(I)+4 : D = 136: GOSUB 1000 : NEXT I
580 A = A * 2 : IF A < 8 THEN GOTO 530
590 R = 23 : D = 0 : GOSUB 1000
600 PRINT "Done!"
610 END

1000 REM PRINT "POKE S+";R;",";D
1005 IF D > 127 THEN D = D - 256
1007 LET ARG = (D * 256) + R + I
1008 REM PRINT "ARG=";ARG
1010 RESULT = USR(ARG)
1015 REM PRINT "USR=";RESULT
1020 RETURN

9000 REM == SID-IO-BAS 0xF800 ==
9001 DATA 205, 241, 11, 123, 230, 96, 71, 123, 230, 15, 88
9010 REM == SID-IO 0xF80B ==
9011 DATA 14,84,179,71,237,81,0,0,0,203,248,237,81
9012 DATA 66,62,0,195,103,19
9020 REM == CLEAR-SID 0xF81E ==
9021 DATA 14,84,6,152,175,237,121,0,0,0,203,184,237
9022 DATA 121,0,0,0,203,248,237,121,201
9999 DATA 999
