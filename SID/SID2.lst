Sjasm Z80 Assembler v0.42c - www.xl2s.tk             [2021.02.14 - 18:49:48]

SID2.ASM
Errors: 0

       1   00:0200                      ; RC2014 SID TESTER
       2   00:0200                      ; Ported from the code in SID2.BAS
       3   00:0200                      ; Should sound like the mp3s in this folder
       4   00:0200                      
       5   00:0200                      			ORG		$0200
       6   00:0200                      
       7   00:0200  CD AA 03            ENTRY:		CALL	CLEAR_SID
       8   00:0203  1E 00               			LD		E, 0
       9   00:0205                      
      10   00:0205  3E 00               			LD		A, 0x00
      11   00:0207  32 9B 03            			LD		(VI), A
      12   00:020A                      
      13   00:020A  3E 18               			LD		A, 0x18
      14   00:020C  16 0F               			LD		D, 0x0F
      15   00:020E  1E 00               			LD		E, 0
      16   00:0210  CD 9C 03            			CALL	SID_IO		; 430 R = 24 : D = 15 : GOSUB 1000
      17   00:0213                      
      18   00:0213  26 00               			LD		H, 0
      19   00:0215                      
      20   00:0215  3E 03               SETUP:		LD		A, 0x03		; 431 FOR I = 0 TO 2
      21   00:0217  84                  			ADD		H
      22   00:0218  16 08               			LD		D, 0x08		
      23   00:021A  1E 00               			LD		E, 0
      24   00:021C  CD 9C 03            			CALL	SID_IO		; 440 R = V(I)+3 : D = 8 : GOSUB 1000
      25   00:021F  3E 01               			LD		A, 0x01
      26   00:0221  84                  			ADD		H
      27   00:0222  16 00               			LD		D, 0x00
      28   00:0224  1E 00               			LD		E, 0
      29   00:0226  CD 9C 03            			CALL	SID_IO		; 441 R = V(I)+1 : D = 0 : GOSUB 1000
      30   00:0229  3E 05               			LD		A, 0x05
      31   00:022B  84                  			ADD		H
      32   00:022C  16 08               			LD		D, 0x08
      33   00:022E  1E 00               			LD		E, 0
      34   00:0230  CD 9C 03            			CALL	SID_IO
      35   00:0233  3E 06               			LD		A, 0x06		; 450 R = V(I)+5 : D = 8 : GOSUB 1000
      36   00:0235  84                  			ADD		H
      37   00:0236  16 C6               			LD		D, 0xC6
      38   00:0238  1E 00               			LD		E, 0
      39   00:023A  CD 9C 03            			CALL	SID_IO		; 451 R = V(I)+6 : D = 198 : GOSUB 1000
      40   00:023D                      
      41   00:023D  7C                  			LD		A, H
      42   00:023E  C6 07               			ADD		0x07
      43   00:0240  FE 15               			CP		0x15
      44   00:0242  CA 49 02            			JP		Z, INITAI
      45   00:0245  67                  			LD		H, A
      46   00:0246  C3 15 02            			JP		SETUP		; 452 NEXT
      47   00:0249                      
      48   00:0249  3E 10               INITAI:		LD		A, 0x10		; 460 FOR A = 16 TO 128 STEP 16
      49   00:024B  32 9A 03            			LD		(VA), A
      50   00:024E                      
      51   00:024E  3E 00               			LD		A, 0x00		; 461 FOR I = 0 TO 2
      52   00:0250  32 9B 03            			LD		(VI), A
      53   00:0253                      
      54   00:0253  3A 9A 03            AILOOP:		LD      A, (VA)		; 470 IF A > 64 THEN R = V(I)+3 : D = 0 : GOSUB 1000
      55   00:0256  FE 40               			CP		0x40		
      56   00:0258  DA 6C 02            			JP		C, CONT
      57   00:025B  CA 6C 02            			JP		Z, CONT
      58   00:025E                      
      59   00:025E  3A 9B 03            			LD		A, (VI)
      60   00:0261  67                  			LD		H, A
      61   00:0262  3E 03               			LD		A, 0x03
      62   00:0264  84                  			ADD		H
      63   00:0265  16 00               			LD		D, 0x00
      64   00:0267  1E 00               			LD		E, 0
      65   00:0269  CD 9C 03            			CALL	SID_IO
      66   00:026C                      
      67   00:026C  3A 9B 03            CONT:		LD		A, (VI)		
      68   00:026F  67                  			LD		H, A
      69   00:0270  3A 9A 03            			LD		A, (VA)		
      70   00:0273  57                  			LD		D, A
      71   00:0274  14                  			INC		D
      72   00:0275  3E 04               			LD		A, 0x04
      73   00:0277  84                  			ADD		H
      74   00:0278  1E 00               			LD		E, 0
      75   00:027A  CD 9C 03            			CALL	SID_IO		; 480 R = V(I)+4 : D = A+1 : GOSUB 1000
      76   00:027D                      
      77   00:027D  3E 00               			LD		A, 0x00
      78   00:027F  57                  			LD		D, A		
      79   00:0280  3A 9B 03            FLOOP1:		LD		A, (VI)		; 490 FOR F = 0 TO 254 STEP 2
      80   00:0283  67                  			LD		H, A
      81   00:0284  3E 01               			LD		A, 0x01
      82   00:0286  84                  			ADD		H
      83   00:0287  1E 00               			LD		E, 0
      84   00:0289  CD 9C 03            			CALL	SID_IO		;491 R = V(I)+1 : D = F : GOSUB 1000...
      85   00:028C                      
      86   00:028C  CD C0 03            			CALL	DELAY
      87   00:028F                      
      88   00:028F  14                  			INC		D
      89   00:0290  14                  			INC		D
      90   00:0291  7A                  			LD		A, D
      91   00:0292  FE 00               			CP		0x00
      92   00:0294  C2 80 02            			JP		NZ, FLOOP1		; ...: NEXT F
      93   00:0297                      
      94   00:0297  3A 9A 03            			LD		A, (VA)		
      95   00:029A  57                  			LD		D, A
      96   00:029B  3A 9B 03            			LD		A, (VI)		
      97   00:029E  67                  			LD		H, A
      98   00:029F  3E 04               			LD		A, 0x04
      99   00:02A1  84                  			ADD		H
     100   00:02A2  1E 00               			LD		E, 0
     101   00:02A4  CD 9C 03            			CALL	SID_IO			; 500 R = V(I)+4 : D = A : GOSUB 1000
     102   00:02A7                      		
     103   00:02A7  3E C8               			LD		A, 0xC8			; 501 FOR W = 0 TO 200...
     104   00:02A9  CD C0 03            WLOOP:		CALL	DELAY
     105   00:02AC  3D                  			DEC		A
     106   00:02AD  FE FF               			CP		0xFF
     107   00:02AF  C2 A9 02            			JP		NZ, WLOOP		; ... : NEXT W
     108   00:02B2                      
     109   00:02B2  3E 08               			LD		A, 0x08			
     110   00:02B4  57                  			LD		D, A
     111   00:02B5  3A 9B 03            			LD		A, (VI)		
     112   00:02B8  67                  			LD		H, A
     113   00:02B9  3E 04               			LD		A, 0x04
     114   00:02BB  84                  			ADD		H
     115   00:02BC  1E 00               			LD		E, 0
     116   00:02BE  CD 9C 03            			CALL	SID_IO			; 510 R = V(I)+4 : D = 8 : GOSUB 1000
     117   00:02C1                      
     118   00:02C1  3E 00               			LD		A, 0x00		
     119   00:02C3  57                  			LD		D, A
     120   00:02C4  3A 9B 03            			LD		A, (VI)		
     121   00:02C7  67                  			LD		H, A
     122   00:02C8  3E 01               			LD		A, 0x01
     123   00:02CA  84                  			ADD		H
     124   00:02CB  1E 00               			LD		E, 0
     125   00:02CD  CD 9C 03            			CALL	SID_IO			; 511 R = V(I)+1 : D = 0 : GOSUB 1000
     126   00:02D0                      
     127   00:02D0  3A 9B 03            			LD		A, (VI)
     128   00:02D3  C6 07               			ADD		0x07
     129   00:02D5  FE 15               			CP		0x15
     130   00:02D7  CA E0 02            			JP		Z, EXITILOOP1
     131   00:02DA  32 9B 03            			LD		(VI), A
     132   00:02DD  C3 53 02            			JP		AILOOP
     133   00:02E0                      
     134   00:02E0  3E 00               EXITILOOP1:	LD		A, 0
     135   00:02E2  32 9B 03            			LD		(VI), A
     136   00:02E5  3A 9A 03            			LD		A, (VA)
     137   00:02E8  C6 10               			ADD		0x10
     138   00:02EA  FE 90               			CP		0x90
     139   00:02EC  CA F5 02            			JP		Z, EXITALOOP
     140   00:02EF  32 9A 03            			LD		(VA), A
     141   00:02F2  C3 53 02            			JP		AILOOP			; 520 NEXT I,A...
     142   00:02F5                      
     143   00:02F5  3E 01               EXITALOOP:	LD		A, 0x01			; ... : A = 1
     144   00:02F7  32 9A 03            			LD		(VA), A
     145   00:02FA  3E 00               INITLOOPI:	LD		A, 0x00
     146   00:02FC  32 9B 03            			LD		(VI), A
     147   00:02FF                      
     148   00:02FF  16 FF               ILOOP:		LD		D, 0xFF			; 530 FOR I = 0 TO 2
     149   00:0301  3A 9B 03            			LD		A, (VI)		
     150   00:0304  67                  			LD		H, A
     151   00:0305  3E 01               			LD		A, 0x01
     152   00:0307  84                  			ADD		H
     153   00:0308  1E 00               			LD		E, 0
     154   00:030A  CD 9C 03            			CALL	SID_IO			; 531 R = V(I)+1 : D = 255 : GOSUB 1000
     155   00:030D                      
     156   00:030D  3A 9A 03            			LD		A, (VA)			
     157   00:0310  CB 27               			SLA		A
     158   00:0312  CB 27               			SLA		A
     159   00:0314  CB 27               			SLA		A
     160   00:0316  CB 27               			SLA		A
     161   00:0318  C6 0F               			ADD		0x0F
     162   00:031A  57                  			LD		D, A
     163   00:031B  3E 18               			LD		A, 0x18
     164   00:031D  1E 00               			LD		E, 0
     165   00:031F  CD 9C 03            			CALL	SID_IO			; 540 R = 24 : D = (A*16)+15: GOSUB 1000
     166   00:0322                      
     167   00:0322  3A 9B 03            			LD		A, (VI)
     168   00:0325  0E 01               			LD		C, 0x01
     169   00:0327  FE 00               PWR:		CP		0x00
     170   00:0329  CA 33 03            			JP		Z, PWRDONE
     171   00:032C  CB 21               			SLA		C
     172   00:032E  D6 07               			SUB		0x07
     173   00:0330  C3 27 03            			JP		PWR
     174   00:0333  51                  PWRDONE:	LD		D, C
     175   00:0334  3E 17               			LD		A, 0x17
     176   00:0336  1E 00               			LD		E, 0
     177   00:0338  CD 9C 03            			CALL	SID_IO			; 541 R = 23 : D = 2^I : GOSUB 1000
     178   00:033B                      
     179   00:033B  16 81               			LD		D, 0x81
     180   00:033D  3A 9B 03            			LD		A, (VI)		
     181   00:0340  67                  			LD		H, A
     182   00:0341  3E 04               			LD		A, 0x04
     183   00:0343  84                  			ADD		H
     184   00:0344  1E 00               			LD		E, 0
     185   00:0346  CD 9C 03            			CALL	SID_IO			; 550 R = V(I)+4 : D = 129 : GOSUB 1000
     186   00:0349                      
     187   00:0349  16 00               			LD		D, 0x00			; 560 FOR F = 0 TO 255
     188   00:034B  3A 9B 03            FLOOP2:		LD		A, (VI)		
     189   00:034E  67                  			LD		H, A
     190   00:034F  3E 16               			LD		A, 0x16
     191   00:0351  1E 00               			LD		E, 0
     192   00:0353  CD 9C 03            			CALL	SID_IO			; 561 R = 22 : D = F : GOSUB 1000...
     193   00:0356                      
     194   00:0356  CD C0 03            			CALL	DELAY
     195   00:0359                      
     196   00:0359  14                  			INC		D
     197   00:035A  7A                  			LD		A, D
     198   00:035B  FE 00               			CP		0x00
     199   00:035D  C2 4B 03            			JP		NZ, FLOOP2		;  ...: NEXT F
     200   00:0360                      
     201   00:0360  3E 88               			LD		A, 0x88
     202   00:0362  57                  			LD		D, A
     203   00:0363  3A 9B 03            			LD		A, (VI)		
     204   00:0366  67                  			LD		H, A
     205   00:0367  3E 04               			LD		A, 0x04
     206   00:0369  84                  			ADD		H
     207   00:036A  1E 00               			LD		E, 0
     208   00:036C  CD 9C 03            			CALL	SID_IO			; 570 R = V(I)+4 : D = 136: GOSUB 1000...
     209   00:036F                      
     210   00:036F  3A 9B 03            			LD		A, (VI)
     211   00:0372  C6 07               			ADD		0x07
     212   00:0374  FE 15               			CP		0x15
     213   00:0376  CA 7F 03            			JP		Z, EXITILOOP2
     214   00:0379  32 9B 03            			LD		(VI), A
     215   00:037C  C3 FF 02            			JP		ILOOP			;  ...: NEXT I
     216   00:037F                      
     217   00:037F  3A 9A 03            EXITILOOP2:	LD		A, (VA)
     218   00:0382  CB 27               			SLA		A
     219   00:0384  FE 08               			CP		0x08
     220   00:0386  D2 8F 03            			JP		NC, EXIT		
     221   00:0389  32 9A 03            			LD		(VA), A
     222   00:038C  C3 FA 02            			JP		INITLOOPI		; 580 A = A * 2 : IF A < 8 THEN GOTO 530
     223   00:038F                      			
     224   00:038F  3E 00               EXIT:		LD		A, 0x0
     225   00:0391  57                  			LD		D, A
     226   00:0392  3E 17               			LD		A, 0x17
     227   00:0394  1E 00               			LD		E, 0
     228   00:0396  CD 9C 03            			CALL	SID_IO			; 590 R = 23 : D = 0 : GOSUB 1000
     229   00:0399                      
     230   00:0399  C7                  			RST		0
     231   00:039A                      
     232   00:039A  00                  VA			DB		0
     233   00:039B  00                  VI			DB		0
     234   00:039C                      
     235   00:039C                      ; ENTER WITH:	A = SID REGISTER (0x00 - 0x18)
     236   00:039C                      ;				D = DATA BYTE
     237   00:039C                      ;				E = INTERRUPT CONTROLLER MODE - BITS 5/6
     238   00:039C                      ; (0x00 = OFF,  0x20 = '50Hz',  0x40 = '60Hz'  0x60 = '100Hz')
     239   00:039C  0E 54               SID_IO:		LD		C, 0x54		; BASE I/O ADDRESS
     240   00:039E  B3                  			OR		E
     241   00:039F  47                  			LD		B, A
     242   00:03A0  ED 51               			OUT		(C), D		; WRITE TO SID.  /CS=0 (B BIT 7)
     243   00:03A2  00                  			NOP
     244   00:03A3  00                  			NOP					; DELAY
     245   00:03A4  00                  			NOP
     246   00:03A5  CB F8               			SET		7, B		; /CS=1 (B BIT 7)
     247   00:03A7  ED 51               			OUT		(C), D		; WRITE TO SID
     248   00:03A9  C9                  			RET
     249   00:03AA                      
     250   00:03AA  0E 54               CLEAR_SID:	LD		C, 0x54		; BASE I/O ADDRESS
     251   00:03AC  06 98               			LD		B, 0x98		; SID REGISTER 0x18, /CS =1 (BIT 7)
     252   00:03AE                      								; INTERRUPT CONTROLLER OFF
     253   00:03AE  AF                  			XOR		A			; OPTIMIZED "LD A, 0" (VOLUME 0)
     254   00:03AF  ED 79               			OUT		(C), A		; FIRSTY OUT TO ENSURE /CS HIGH
     255   00:03B1  00                  			NOP
     256   00:03B2  00                  			NOP					; DELAY
     257   00:03B3  00                  			NOP
     258   00:03B4  CB B8               			RES		7, B		; /CS=0 (B BIT 7)
     259   00:03B6  ED 79               			OUT		(C), A		; WRITE TO SID
     260   00:03B8  00                  			NOP
     261   00:03B9  00                  			NOP					; DELAY
     262   00:03BA  00                  			NOP
     263   00:03BB  CB F8               			SET		7, B		; /CS=1 (B BIT 7)
     264   00:03BD  ED 79               			OUT		(C), A		; WRITE TO SID
     265   00:03BF  C9                  			RET		
     266   00:03C0                      
     267   00:03C0  06 10               DELAY:		LD		B, 0x10
     268   00:03C2  0E FF               DELAYOUT:	LD		C, 0xFF
     269   00:03C4  0D                  DELAYIN:	DEC		C
     270   00:03C5  79                  			LD		A, C
     271   00:03C6  FE 00               			CP		0x00
     272   00:03C8  C2 C4 03            			JP		NZ, DELAYIN
     273   00:03CB  05                  			DEC		B
     274   00:03CC  78                  			LD		A, B
     275   00:03CD  FE 00               			CP		0x00
     276   00:03CF  C2 C2 03            			JP		NZ, DELAYOUT
     277   00:03D2  C9                  			RET
     278   00:03D3                      

    LABELS
-------------------------------------------------
00:00000200 X ENTRY
00:00000215   SETUP
00:00000249   INITAI
00:00000253   AILOOP
00:0000026C   CONT
00:00000280   FLOOP1
00:000002A9   WLOOP
00:000002E0   EXITILOOP1
00:000002F5   EXITALOOP
00:000002FA   INITLOOPI
00:000002FF   ILOOP
00:00000327   PWR
00:00000333   PWRDONE
00:0000034B   FLOOP2
00:0000037F   EXITILOOP2
00:0000038F   EXIT
00:0000039A   VA
00:0000039B   VI
00:0000039C   SID_IO
00:000003AA   CLEAR_SID
00:000003C0   DELAY
00:000003C2   DELAYOUT
00:000003C4   DELAYIN


 Output: SID2.OUT
-------------------------------------------------

 Page: 00
  Org: 00000200  Size: *  Used: 000001D3

   Address   Length Align   Label
   00000200     467         ENTRY
