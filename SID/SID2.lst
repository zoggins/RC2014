Sjasm Z80 Assembler v0.42c - www.xl2s.tk             [2021.02.14 - 19:31:41]

SID2.ASM
Errors: 0

       1   00:0200                      ; RC2014 SID TESTER
       2   00:0200                      ; Ported from the code in SID2.BAS
       3   00:0200                      ; Should sound similiar to the mp3s in this folder
       4   00:0200                      ; Might be faster or slower depending on your setup
       5   00:0200                      
       6   00:0200                      			ORG		$0200
       7   00:0200                      
       8   00:0200  CD A7 03            ENTRY:		CALL	CLEAR_SID
       9   00:0203  1E 00               			LD		E, 0
      10   00:0205                      
      11   00:0205  3E 00               			LD		A, 0x00
      12   00:0207  32 98 03            			LD		(VI), A
      13   00:020A                      
      14   00:020A  3E 18               			LD		A, 0x18
      15   00:020C  16 0F               			LD		D, 0x0F
      16   00:020E  1E 00               			LD		E, 0
      17   00:0210  CD 99 03            			CALL	SID_IO		; 430 R = 24 : D = 15 : GOSUB 1000
      18   00:0213                      
      19   00:0213  26 00               			LD		H, 0
      20   00:0215                      
      21   00:0215  3E 03               SETUP:		LD		A, 0x03		; 431 FOR I = 0 TO 2
      22   00:0217  84                  			ADD		H
      23   00:0218  16 08               			LD		D, 0x08		
      24   00:021A  1E 00               			LD		E, 0
      25   00:021C  CD 99 03            			CALL	SID_IO		; 440 R = V(I)+3 : D = 8 : GOSUB 1000
      26   00:021F  3E 01               			LD		A, 0x01
      27   00:0221  84                  			ADD		H
      28   00:0222  16 00               			LD		D, 0x00
      29   00:0224  1E 00               			LD		E, 0
      30   00:0226  CD 99 03            			CALL	SID_IO		; 441 R = V(I)+1 : D = 0 : GOSUB 1000
      31   00:0229  3E 05               			LD		A, 0x05
      32   00:022B  84                  			ADD		H
      33   00:022C  16 08               			LD		D, 0x08
      34   00:022E  1E 00               			LD		E, 0
      35   00:0230  CD 99 03            			CALL	SID_IO
      36   00:0233  3E 06               			LD		A, 0x06		; 450 R = V(I)+5 : D = 8 : GOSUB 1000
      37   00:0235  84                  			ADD		H
      38   00:0236  16 C6               			LD		D, 0xC6
      39   00:0238  1E 00               			LD		E, 0
      40   00:023A  CD 99 03            			CALL	SID_IO		; 451 R = V(I)+6 : D = 198 : GOSUB 1000
      41   00:023D                      
      42   00:023D  7C                  			LD		A, H
      43   00:023E  C6 07               			ADD		0x07
      44   00:0240  FE 15               			CP		0x15
      45   00:0242  CA 49 02            			JP		Z, INITAI
      46   00:0245  67                  			LD		H, A
      47   00:0246  C3 15 02            			JP		SETUP		; 452 NEXT
      48   00:0249                      
      49   00:0249  3E 10               INITAI:		LD		A, 0x10		; 460 FOR A = 16 TO 128 STEP 16
      50   00:024B  32 97 03            			LD		(VA), A
      51   00:024E                      
      52   00:024E  3E 00               			LD		A, 0x00		; 461 FOR I = 0 TO 2
      53   00:0250  32 98 03            			LD		(VI), A
      54   00:0253                      
      55   00:0253  3A 97 03            AILOOP:		LD      A, (VA)		; 470 IF A > 64 THEN R = V(I)+3 : D = 0 : GOSUB 1000
      56   00:0256  FE 40               			CP		0x40		
      57   00:0258  DA 6C 02            			JP		C, CONT
      58   00:025B  CA 6C 02            			JP		Z, CONT
      59   00:025E                      
      60   00:025E  3A 98 03            			LD		A, (VI)
      61   00:0261  67                  			LD		H, A
      62   00:0262  3E 03               			LD		A, 0x03
      63   00:0264  84                  			ADD		H
      64   00:0265  16 00               			LD		D, 0x00
      65   00:0267  1E 00               			LD		E, 0
      66   00:0269  CD 99 03            			CALL	SID_IO
      67   00:026C                      
      68   00:026C  3A 98 03            CONT:		LD		A, (VI)		
      69   00:026F  67                  			LD		H, A
      70   00:0270  3A 97 03            			LD		A, (VA)		
      71   00:0273  57                  			LD		D, A
      72   00:0274  14                  			INC		D
      73   00:0275  3E 04               			LD		A, 0x04
      74   00:0277  84                  			ADD		H
      75   00:0278  1E 00               			LD		E, 0
      76   00:027A  CD 99 03            			CALL	SID_IO		; 480 R = V(I)+4 : D = A+1 : GOSUB 1000
      77   00:027D                      
      78   00:027D  3E 00               			LD		A, 0x00
      79   00:027F  57                  			LD		D, A		
      80   00:0280  3A 98 03            FLOOP1:		LD		A, (VI)		; 490 FOR F = 0 TO 254 STEP 2
      81   00:0283  67                  			LD		H, A
      82   00:0284  3E 01               			LD		A, 0x01
      83   00:0286  84                  			ADD		H
      84   00:0287  1E 00               			LD		E, 0
      85   00:0289  CD 99 03            			CALL	SID_IO		;491 R = V(I)+1 : D = F : GOSUB 1000...
      86   00:028C                      
      87   00:028C  CD BD 03            			CALL	DELAY
      88   00:028F                      
      89   00:028F  14                  			INC		D
      90   00:0290  14                  			INC		D
      91   00:0291  7A                  			LD		A, D
      92   00:0292  FE 00               			CP		0x00
      93   00:0294  C2 80 02            			JP		NZ, FLOOP1		; ...: NEXT F
      94   00:0297                      
      95   00:0297  3A 97 03            			LD		A, (VA)		
      96   00:029A  57                  			LD		D, A
      97   00:029B  3A 98 03            			LD		A, (VI)		
      98   00:029E  67                  			LD		H, A
      99   00:029F  3E 04               			LD		A, 0x04
     100   00:02A1  84                  			ADD		H
     101   00:02A2  1E 00               			LD		E, 0
     102   00:02A4  CD 99 03            			CALL	SID_IO			; 500 R = V(I)+4 : D = A : GOSUB 1000
     103   00:02A7                      		
     104   00:02A7  3E C8               			LD		A, 0xC8			; 501 FOR W = 0 TO 200...
     105   00:02A9  3D                  WLOOP:		DEC		A
     106   00:02AA  FE FF               			CP		0xFF
     107   00:02AC  C2 A9 02            			JP		NZ, WLOOP		; ... : NEXT W
     108   00:02AF                      
     109   00:02AF  3E 08               			LD		A, 0x08			
     110   00:02B1  57                  			LD		D, A
     111   00:02B2  3A 98 03            			LD		A, (VI)		
     112   00:02B5  67                  			LD		H, A
     113   00:02B6  3E 04               			LD		A, 0x04
     114   00:02B8  84                  			ADD		H
     115   00:02B9  1E 00               			LD		E, 0
     116   00:02BB  CD 99 03            			CALL	SID_IO			; 510 R = V(I)+4 : D = 8 : GOSUB 1000
     117   00:02BE                      
     118   00:02BE  3E 00               			LD		A, 0x00		
     119   00:02C0  57                  			LD		D, A
     120   00:02C1  3A 98 03            			LD		A, (VI)		
     121   00:02C4  67                  			LD		H, A
     122   00:02C5  3E 01               			LD		A, 0x01
     123   00:02C7  84                  			ADD		H
     124   00:02C8  1E 00               			LD		E, 0
     125   00:02CA  CD 99 03            			CALL	SID_IO			; 511 R = V(I)+1 : D = 0 : GOSUB 1000
     126   00:02CD                      
     127   00:02CD  3A 98 03            			LD		A, (VI)
     128   00:02D0  C6 07               			ADD		0x07
     129   00:02D2  FE 15               			CP		0x15
     130   00:02D4  CA DD 02            			JP		Z, EXITILOOP1
     131   00:02D7  32 98 03            			LD		(VI), A
     132   00:02DA  C3 53 02            			JP		AILOOP
     133   00:02DD                      
     134   00:02DD  3E 00               EXITILOOP1:	LD		A, 0
     135   00:02DF  32 98 03            			LD		(VI), A
     136   00:02E2  3A 97 03            			LD		A, (VA)
     137   00:02E5  C6 10               			ADD		0x10
     138   00:02E7  FE 90               			CP		0x90
     139   00:02E9  CA F2 02            			JP		Z, EXITALOOP
     140   00:02EC  32 97 03            			LD		(VA), A
     141   00:02EF  C3 53 02            			JP		AILOOP			; 520 NEXT I,A...
     142   00:02F2                      
     143   00:02F2  3E 01               EXITALOOP:	LD		A, 0x01			; ... : A = 1
     144   00:02F4  32 97 03            			LD		(VA), A
     145   00:02F7  3E 00               INITLOOPI:	LD		A, 0x00
     146   00:02F9  32 98 03            			LD		(VI), A
     147   00:02FC                      
     148   00:02FC  16 FF               ILOOP:		LD		D, 0xFF			; 530 FOR I = 0 TO 2
     149   00:02FE  3A 98 03            			LD		A, (VI)		
     150   00:0301  67                  			LD		H, A
     151   00:0302  3E 01               			LD		A, 0x01
     152   00:0304  84                  			ADD		H
     153   00:0305  1E 00               			LD		E, 0
     154   00:0307  CD 99 03            			CALL	SID_IO			; 531 R = V(I)+1 : D = 255 : GOSUB 1000
     155   00:030A                      
     156   00:030A  3A 97 03            			LD		A, (VA)			
     157   00:030D  CB 27               			SLA		A
     158   00:030F  CB 27               			SLA		A
     159   00:0311  CB 27               			SLA		A
     160   00:0313  CB 27               			SLA		A
     161   00:0315  C6 0F               			ADD		0x0F
     162   00:0317  57                  			LD		D, A
     163   00:0318  3E 18               			LD		A, 0x18
     164   00:031A  1E 00               			LD		E, 0
     165   00:031C  CD 99 03            			CALL	SID_IO			; 540 R = 24 : D = (A*16)+15: GOSUB 1000
     166   00:031F                      
     167   00:031F  3A 98 03            			LD		A, (VI)
     168   00:0322  0E 01               			LD		C, 0x01
     169   00:0324  FE 00               PWR:		CP		0x00
     170   00:0326  CA 30 03            			JP		Z, PWRDONE
     171   00:0329  CB 21               			SLA		C
     172   00:032B  D6 07               			SUB		0x07
     173   00:032D  C3 24 03            			JP		PWR
     174   00:0330  51                  PWRDONE:	LD		D, C
     175   00:0331  3E 17               			LD		A, 0x17
     176   00:0333  1E 00               			LD		E, 0
     177   00:0335  CD 99 03            			CALL	SID_IO			; 541 R = 23 : D = 2^I : GOSUB 1000
     178   00:0338                      
     179   00:0338  16 81               			LD		D, 0x81
     180   00:033A  3A 98 03            			LD		A, (VI)		
     181   00:033D  67                  			LD		H, A
     182   00:033E  3E 04               			LD		A, 0x04
     183   00:0340  84                  			ADD		H
     184   00:0341  1E 00               			LD		E, 0
     185   00:0343  CD 99 03            			CALL	SID_IO			; 550 R = V(I)+4 : D = 129 : GOSUB 1000
     186   00:0346                      
     187   00:0346  16 00               			LD		D, 0x00			; 560 FOR F = 0 TO 255
     188   00:0348  3A 98 03            FLOOP2:		LD		A, (VI)		
     189   00:034B  67                  			LD		H, A
     190   00:034C  3E 16               			LD		A, 0x16
     191   00:034E  1E 00               			LD		E, 0
     192   00:0350  CD 99 03            			CALL	SID_IO			; 561 R = 22 : D = F : GOSUB 1000...
     193   00:0353                      
     194   00:0353  CD BD 03            			CALL	DELAY
     195   00:0356                      
     196   00:0356  14                  			INC		D
     197   00:0357  7A                  			LD		A, D
     198   00:0358  FE 00               			CP		0x00
     199   00:035A  C2 48 03            			JP		NZ, FLOOP2		;  ...: NEXT F
     200   00:035D                      
     201   00:035D  3E 88               			LD		A, 0x88
     202   00:035F  57                  			LD		D, A
     203   00:0360  3A 98 03            			LD		A, (VI)		
     204   00:0363  67                  			LD		H, A
     205   00:0364  3E 04               			LD		A, 0x04
     206   00:0366  84                  			ADD		H
     207   00:0367  1E 00               			LD		E, 0
     208   00:0369  CD 99 03            			CALL	SID_IO			; 570 R = V(I)+4 : D = 136: GOSUB 1000...
     209   00:036C                      
     210   00:036C  3A 98 03            			LD		A, (VI)
     211   00:036F  C6 07               			ADD		0x07
     212   00:0371  FE 15               			CP		0x15
     213   00:0373  CA 7C 03            			JP		Z, EXITILOOP2
     214   00:0376  32 98 03            			LD		(VI), A
     215   00:0379  C3 FC 02            			JP		ILOOP			;  ...: NEXT I
     216   00:037C                      
     217   00:037C  3A 97 03            EXITILOOP2:	LD		A, (VA)
     218   00:037F  CB 27               			SLA		A
     219   00:0381  FE 08               			CP		0x08
     220   00:0383  D2 8C 03            			JP		NC, EXIT		
     221   00:0386  32 97 03            			LD		(VA), A
     222   00:0389  C3 F7 02            			JP		INITLOOPI		; 580 A = A * 2 : IF A < 8 THEN GOTO 530
     223   00:038C                      			
     224   00:038C  3E 00               EXIT:		LD		A, 0x0
     225   00:038E  57                  			LD		D, A
     226   00:038F  3E 17               			LD		A, 0x17
     227   00:0391  1E 00               			LD		E, 0
     228   00:0393  CD 99 03            			CALL	SID_IO			; 590 R = 23 : D = 0 : GOSUB 1000
     229   00:0396                      
     230   00:0396  C7                  			RST		0
     231   00:0397                      
     232   00:0397  00                  VA			DB		0
     233   00:0398  00                  VI			DB		0
     234   00:0399                      
     235   00:0399                      ; ENTER WITH:	A = SID REGISTER (0x00 - 0x18)
     236   00:0399                      ;				D = DATA BYTE
     237   00:0399                      ;				E = INTERRUPT CONTROLLER MODE - BITS 5/6
     238   00:0399                      ; (0x00 = OFF,  0x20 = '50Hz',  0x40 = '60Hz'  0x60 = '100Hz')
     239   00:0399  0E 54               SID_IO:		LD		C, 0x54		; BASE I/O ADDRESS
     240   00:039B  B3                  			OR		E
     241   00:039C  47                  			LD		B, A
     242   00:039D  ED 51               			OUT		(C), D		; WRITE TO SID.  /CS=0 (B BIT 7)
     243   00:039F  00                  			NOP
     244   00:03A0  00                  			NOP					; DELAY
     245   00:03A1  00                  			NOP
     246   00:03A2  CB F8               			SET		7, B		; /CS=1 (B BIT 7)
     247   00:03A4  ED 51               			OUT		(C), D		; WRITE TO SID
     248   00:03A6  C9                  			RET
     249   00:03A7                      
     250   00:03A7  0E 54               CLEAR_SID:	LD		C, 0x54		; BASE I/O ADDRESS
     251   00:03A9  06 98               			LD		B, 0x98		; SID REGISTER 0x18, /CS =1 (BIT 7)
     252   00:03AB                      								; INTERRUPT CONTROLLER OFF
     253   00:03AB  AF                  			XOR		A			; OPTIMIZED "LD A, 0" (VOLUME 0)
     254   00:03AC  ED 79               			OUT		(C), A		; FIRSTY OUT TO ENSURE /CS HIGH
     255   00:03AE  00                  			NOP
     256   00:03AF  00                  			NOP					; DELAY
     257   00:03B0  00                  			NOP
     258   00:03B1  CB B8               			RES		7, B		; /CS=0 (B BIT 7)
     259   00:03B3  ED 79               			OUT		(C), A		; WRITE TO SID
     260   00:03B5  00                  			NOP
     261   00:03B6  00                  			NOP					; DELAY
     262   00:03B7  00                  			NOP
     263   00:03B8  CB F8               			SET		7, B		; /CS=1 (B BIT 7)
     264   00:03BA  ED 79               			OUT		(C), A		; WRITE TO SID
     265   00:03BC  C9                  			RET		
     266   00:03BD                      
     267   00:03BD  06 10               DELAY:		LD		B, 0x10
     268   00:03BF  0E FF               DELAYOUT:	LD		C, 0xFF
     269   00:03C1  0D                  DELAYIN:	DEC		C
     270   00:03C2  79                  			LD		A, C
     271   00:03C3  FE 00               			CP		0x00
     272   00:03C5  C2 C1 03            			JP		NZ, DELAYIN
     273   00:03C8  05                  			DEC		B
     274   00:03C9  78                  			LD		A, B
     275   00:03CA  FE 00               			CP		0x00
     276   00:03CC  C2 BF 03            			JP		NZ, DELAYOUT
     277   00:03CF  C9                  			RET
     278   00:03D0                      

    LABELS
-------------------------------------------------
00:00000200 X ENTRY
00:00000215   SETUP
00:00000249   INITAI
00:00000253   AILOOP
00:0000026C   CONT
00:00000280   FLOOP1
00:000002A9   WLOOP
00:000002DD   EXITILOOP1
00:000002F2   EXITALOOP
00:000002F7   INITLOOPI
00:000002FC   ILOOP
00:00000324   PWR
00:00000330   PWRDONE
00:00000348   FLOOP2
00:0000037C   EXITILOOP2
00:0000038C   EXIT
00:00000397   VA
00:00000398   VI
00:00000399   SID_IO
00:000003A7   CLEAR_SID
00:000003BD   DELAY
00:000003BF   DELAYOUT
00:000003C1   DELAYIN


 Output: SID2.OUT
-------------------------------------------------

 Page: 00
  Org: 00000200  Size: *  Used: 000001D0

   Address   Length Align   Label
   00000200     464         ENTRY
